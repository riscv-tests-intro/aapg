stages:
  - test

before_script:
    - source /tools/setup.sh
    - git checkout 69-priv-modes
    - git pull
    - export PYTHONPATH=$(pwd)
    - export PATH="/home/lavanya/.pyenv/bin:$PATH"
    - eval "$(pyenv init -)"
    - eval "$(pyenv virtualenv-init -)"
    - pyenv activate py37
    - pip install pytest
    - pip install pytest-timeout
    - pip uninstall -y aapg
    - python setup.py install
    

test:
    script:
        - pytest tests/test_aapg.py -m "serial" -v
        - pytest tests/test_aapg.py -n 10 -m "not serial" -v
    tags:
        - mathsya-shakti

